# =============================================================================
# FLOW NET2NET TRAINING CONFIGURATION
# Optimized for Stage 2 (Biaxial Extension)
# =============================================================================

seed: 42
mode: multi_stage 

# --- Flow Selection ---
flow_types:
  - biaxial_extension

# --- Physics Model ---
model_type: maxwell_B
eta0: 1.0
lam: 0.5
lam_r: 1.0

# --- Checkpoint Handling ---
# We point DIRECTLY to the Stage 1 Best Checkpoint here.
transfer_checkpoint: null
# --- Data Settings ---
n_samples: 3000  # Explicitly set to 3000 for Stage 2

data:
  scaling_mode: standard
  replay_ratio: 0.2

# --- Model Architecture ---
# Hardcoded to 128 (Small Brain) for Stage 2
model:
  layers: [9, 128, 128, 128, 6]  
  dropout: 0.0            
  activation: tanh         

# --- Training Hyperparameters ---
training:
  lambda_phys: 0.3    
  
  # Stage 2 Settings (Fast Adaptation)
  num_epochs: 1000    
  finetune_epochs: 1000 # Used if transfer is active
  
  batch_size: 128         
  learning_rate: 1e-4    
  weight_decay: 1e-4